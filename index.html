<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webパチンコシミュレーター</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        .machine { max-width: 400px; margin: 0 auto; border: 4px solid #444; border-radius: 20px; padding: 20px; background: #333; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .screen { background: #000; height: 200px; border-radius: 10px; border: 2px solid #555; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; margin-bottom: 20px; overflow: hidden; position: relative; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; font-size: 0.9rem; }
        .stat-item { background: #444; padding: 10px; border-radius: 5px; }
        button { background: linear-gradient(to bottom, #ff4444, #990000); color: white; border: none; padding: 15px 30px; font-size: 1.2rem; border-radius: 50px; cursor: pointer; box-shadow: 0 4px #660000; width: 100%; touch-action: manipulation; }
        button:active { transform: translateY(4px); box-shadow: none; }
        .log { margin-top: 20px; text-align: left; height: 100px; overflow-y: auto; background: #222; padding: 10px; font-size: 0.8rem; border-radius: 5px; }
        .hit { color: #ffeb3b; text-shadow: 0 0 10px #ffeb3b; animation: blink 0.2s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="machine">
    <div id="screen" class="screen">
        <div id="display">READY</div>
    </div>

    <div class="stat-grid">
        <div class="stat-item">回転数<br><span id="count">0</span></div>
        <div class="stat-item">投資<br><span id="investment">0</span>円</div>
        <div class="stat-item">大当り回数<br><span id="hits">0</span></div>
        <div class="stat-item">収支<br><span id="balance">0</span>円</div>
    </div>

    <button onclick="play()">Start!</button>

    <div class="log" id="log">履歴:<br></div>
</div>

<script>
    let count = 0;
    let hits = 0;
    let investment = 0;
    let totalReturn = 0;
    const probability = 319.7;
    const payout = 1500; // 1回あたりの出玉イメージ
    let isRolling = false;

    function play() {
        if (isRolling) return;
        
        isRolling = true;
        count++;
        investment += 20; // 1回転20円（千円50回転計算）
        document.getElementById('count').innerText = count;
        document.getElementById('investment').innerText = investment;
        
        const display = document.getElementById('display');
        display.classList.remove('hit');
        display.innerText = "抽選中...";

        // 演出時間を少し作る（0.3秒）
        setTimeout(() => {
            if (Math.random() < 1 / probability) {
                handleHit();
            } else {
                display.innerText = Math.floor(Math.random() * 10);
                updateBalance();
            }
            isRolling = false;
        }, 300);
    }

    function handleHit() {
        hits++;
        totalReturn += payout;
        const display = document.getElementById('display');
        display.innerText = "大当り!";
        display.classList.add('hit');
        document.getElementById('hits').innerText = hits;
        
        const log = document.getElementById('log');
        log.innerHTML += `> ${count}回目 大当り!<br>`;
        log.scrollTop = log.scrollHeight;
        
        updateBalance();
    }

    function updateBalance() {
        const balance = totalReturn - investment;
        const balanceEl = document.getElementById('balance');
        balanceEl.innerText = balance;
        balanceEl.style.color = balance >= 0 ? "#4caf50" : "#ff4444";
    }
</script>

</body>
</html>